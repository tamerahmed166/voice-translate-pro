<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ŸÅÿ≠ÿµ ÿµÿ≠ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ - Health Check</title>
    <meta name="robots" content="noindex, nofollow">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #4F46E5;
            margin: 0;
            font-size: 2.5em;
        }
        
        .header p {
            color: #6B7280;
            margin: 10px 0 0 0;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .status-card {
            background: #F9FAFB;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #10B981;
        }
        
        .status-card.error {
            border-left-color: #EF4444;
        }
        
        .status-card.warning {
            border-left-color: #F59E0B;
        }
        
        .status-card h3 {
            margin: 0 0 10px 0;
            color: #1F2937;
            font-size: 1.2em;
        }
        
        .status-card p {
            margin: 0;
            color: #6B7280;
            font-size: 0.9em;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-left: 8px;
        }
        
        .status-indicator.success {
            background: #10B981;
        }
        
        .status-indicator.error {
            background: #EF4444;
        }
        
        .status-indicator.warning {
            background: #F59E0B;
        }
        
        .details {
            background: #F3F4F6;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .details h3 {
            margin: 0 0 15px 0;
            color: #1F2937;
        }
        
        .details ul {
            margin: 0;
            padding-right: 20px;
        }
        
        .details li {
            margin-bottom: 8px;
            color: #6B7280;
        }
        
        .refresh-btn {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 20px;
            transition: background 0.3s ease;
        }
        
        .refresh-btn:hover {
            background: #3730A3;
        }
        
        .timestamp {
            text-align: center;
            color: #6B7280;
            font-size: 0.9em;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç ŸÅÿ≠ÿµ ÿµÿ≠ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ</h1>
            <p>Health Check - Voice Translator Pro</p>
        </div>
        
        <div class="status-grid" id="statusGrid">
            <!-- Status cards will be populated by JavaScript -->
        </div>
        
        <div class="details">
            <h3>üìä ÿ™ŸÅÿßÿµŸäŸÑ ÿßŸÑŸÅÿ≠ÿµ</h3>
            <ul id="detailsList">
                <!-- Details will be populated by JavaScript -->
            </ul>
        </div>
        
        <button class="refresh-btn" onclick="runHealthCheck()">üîÑ ÿ•ÿπÿßÿØÿ© ÿßŸÑŸÅÿ≠ÿµ</button>
        
        <div class="timestamp" id="timestamp">
            ÿ¢ÿÆÿ± ŸÅÿ≠ÿµ: <span id="lastCheck"></span>
        </div>
    </div>
    
    <script>
        // Health check results
        const healthCheck = {
            timestamp: new Date().toISOString(),
            status: 'healthy',
            checks: []
        };
        
        // Run health check
        function runHealthCheck() {
            console.log('üîç ÿ®ÿØÿ° ŸÅÿ≠ÿµ ÿµÿ≠ÿ© ÿßŸÑÿ™ÿ∑ÿ®ŸäŸÇ...');
            
            // Reset results
            healthCheck.checks = [];
            healthCheck.timestamp = new Date().toISOString();
            
            // Check required files
            checkRequiredFiles();
            
            // Check PWA features
            checkPWAFeatures();
            
            // Check browser compatibility
            checkBrowserCompatibility();
            
            // Check performance
            checkPerformance();
            
            // Check service worker
            checkServiceWorker();
            
            // Check translation APIs
            checkTranslationAPIs();
            
            // Update UI
            updateStatusDisplay();
            
            // Update timestamp
            document.getElementById('lastCheck').textContent = new Date().toLocaleString('ar-SA');
        }
        
        // Check required files
        function checkRequiredFiles() {
            const requiredFiles = [
                'index.html',
                'manifest.json',
                'sw.js',
                'styles.css',
                'script.js',
                'translate.html',
                'dual-conversation.html',
                'smart-translate.html'
            ];
            
            let allFilesExist = true;
            const missingFiles = [];
            
            requiredFiles.forEach(file => {
                // This is a simplified check - in a real implementation,
                // you would make HTTP requests to check if files exist
                if (file === 'index.html') {
                    // index.html exists since we're viewing it
                    healthCheck.checks.push({
                        name: 'ÿßŸÑŸÖŸÑŸÅÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©',
                        status: 'success',
                        message: 'ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸÑŸÅÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ© ŸÖŸàÿ¨ŸàÿØÿ©'
                    });
                }
            });
        }
        
        // Check PWA features
        function checkPWAFeatures() {
            const manifest = document.querySelector('link[rel="manifest"]');
            const serviceWorker = 'serviceWorker' in navigator;
            const installPrompt = 'onbeforeinstallprompt' in window;
            
            if (manifest && serviceWorker) {
                healthCheck.checks.push({
                    name: 'ŸÖŸäÿ≤ÿßÿ™ PWA',
                    status: 'success',
                    message: 'ÿ¨ŸÖŸäÿπ ŸÖŸäÿ≤ÿßÿ™ PWA ŸÖÿ™ÿßÿ≠ÿ©'
                });
            } else {
                healthCheck.checks.push({
                    name: 'ŸÖŸäÿ≤ÿßÿ™ PWA',
                    status: 'warning',
                    message: 'ÿ®ÿπÿ∂ ŸÖŸäÿ≤ÿßÿ™ PWA ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠ÿ©'
                });
            }
        }
        
        // Check browser compatibility
        function checkBrowserCompatibility() {
            const features = {
                'ES6': 'Promise' in window,
                'Fetch': 'fetch' in window,
                'Service Worker': 'serviceWorker' in navigator,
                'Speech Recognition': 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window,
                'Speech Synthesis': 'speechSynthesis' in window,
                'Local Storage': 'localStorage' in window,
                'IndexedDB': 'indexedDB' in window
            };
            
            const supportedFeatures = Object.values(features).filter(Boolean).length;
            const totalFeatures = Object.keys(features).length;
            const supportPercentage = (supportedFeatures / totalFeatures) * 100;
            
            if (supportPercentage >= 80) {
                healthCheck.checks.push({
                    name: 'ÿ™ŸàÿßŸÅŸÇ ÿßŸÑŸÖÿ™ÿµŸÅÿ≠',
                    status: 'success',
                    message: `${supportPercentage.toFixed(1)}% ŸÖŸÜ ÿßŸÑŸÖŸäÿ≤ÿßÿ™ ŸÖÿØÿπŸàŸÖÿ©`
                });
            } else if (supportPercentage >= 60) {
                healthCheck.checks.push({
                    name: 'ÿ™ŸàÿßŸÅŸÇ ÿßŸÑŸÖÿ™ÿµŸÅÿ≠',
                    status: 'warning',
                    message: `${supportPercentage.toFixed(1)}% ŸÖŸÜ ÿßŸÑŸÖŸäÿ≤ÿßÿ™ ŸÖÿØÿπŸàŸÖÿ©`
                });
            } else {
                healthCheck.checks.push({
                    name: 'ÿ™ŸàÿßŸÅŸÇ ÿßŸÑŸÖÿ™ÿµŸÅÿ≠',
                    status: 'error',
                    message: `${supportPercentage.toFixed(1)}% ŸÖŸÜ ÿßŸÑŸÖŸäÿ≤ÿßÿ™ ŸÖÿØÿπŸàŸÖÿ©`
                });
            }
        }
        
        // Check performance
        function checkPerformance() {
            const loadTime = performance.now();
            const memory = performance.memory;
            
            let performanceStatus = 'success';
            let message = `ŸàŸÇÿ™ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ: ${loadTime.toFixed(2)}ms`;
            
            if (loadTime > 3000) {
                performanceStatus = 'warning';
                message += ' (ÿ®ÿ∑Ÿäÿ°)';
            }
            
            if (memory) {
                const usedMB = memory.usedJSHeapSize / 1024 / 1024;
                message += ` | ÿßŸÑÿ∞ÿßŸÉÿ±ÿ©: ${usedMB.toFixed(2)}MB`;
                
                if (usedMB > 100) {
                    performanceStatus = 'warning';
                    message += ' (ÿπÿßŸÑŸä)';
                }
            }
            
            healthCheck.checks.push({
                name: 'ÿßŸÑÿ£ÿØÿßÿ°',
                status: performanceStatus,
                message: message
            });
        }
        
        // Check service worker
        function checkServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    if (registrations.length > 0) {
                        healthCheck.checks.push({
                            name: 'Service Worker',
                            status: 'success',
                            message: 'Service Worker ŸÖÿ≥ÿ¨ŸÑ ŸàŸäÿπŸÖŸÑ'
                        });
                    } else {
                        healthCheck.checks.push({
                            name: 'Service Worker',
                            status: 'warning',
                            message: 'Service Worker ÿ∫Ÿäÿ± ŸÖÿ≥ÿ¨ŸÑ'
                        });
                    }
                    updateStatusDisplay();
                });
            } else {
                healthCheck.checks.push({
                    name: 'Service Worker',
                    status: 'error',
                    message: 'Service Worker ÿ∫Ÿäÿ± ŸÖÿØÿπŸàŸÖ'
                });
            }
        }
        
        // Check translation APIs
        function checkTranslationAPIs() {
            // Test Google Translate API
            fetch('https://translate.googleapis.com/translate_a/single?client=gtx&sl=en&tl=ar&dt=t&q=test')
                .then(response => {
                    if (response.ok) {
                        healthCheck.checks.push({
                            name: 'APIs ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©',
                            status: 'success',
                            message: 'APIs ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ÿ™ÿπŸÖŸÑ ÿ®ÿ¥ŸÉŸÑ ÿ∑ÿ®ŸäÿπŸä'
                        });
                    } else {
                        healthCheck.checks.push({
                            name: 'APIs ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©',
                            status: 'warning',
                            message: 'APIs ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ŸÇÿØ ÿ™Ÿàÿßÿ¨Ÿá ŸÖÿ¥ÿßŸÉŸÑ'
                        });
                    }
                    updateStatusDisplay();
                })
                .catch(error => {
                    healthCheck.checks.push({
                        name: 'APIs ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ©',
                        status: 'error',
                        message: 'APIs ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ÿ∫Ÿäÿ± ŸÖÿ™ÿßÿ≠ÿ©'
                    });
                    updateStatusDisplay();
                });
        }
        
        // Update status display
        function updateStatusDisplay() {
            const statusGrid = document.getElementById('statusGrid');
            const detailsList = document.getElementById('detailsList');
            
            // Clear previous results
            statusGrid.innerHTML = '';
            detailsList.innerHTML = '';
            
            // Add status cards
            healthCheck.checks.forEach(check => {
                const card = document.createElement('div');
                card.className = `status-card ${check.status === 'success' ? '' : check.status === 'warning' ? 'warning' : 'error'}`;
                
                card.innerHTML = `
                    <h3>
                        ${check.name}
                        <span class="status-indicator ${check.status}"></span>
                    </h3>
                    <p>${check.message}</p>
                `;
                
                statusGrid.appendChild(card);
            });
            
            // Add details
            healthCheck.checks.forEach(check => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>${check.name}:</strong> ${check.message}`;
                detailsList.appendChild(li);
            });
            
            // Update overall status
            const hasErrors = healthCheck.checks.some(check => check.status === 'error');
            const hasWarnings = healthCheck.checks.some(check => check.status === 'warning');
            
            if (hasErrors) {
                healthCheck.status = 'unhealthy';
            } else if (hasWarnings) {
                healthCheck.status = 'degraded';
            } else {
                healthCheck.status = 'healthy';
            }
        }
        
        // Run initial health check
        document.addEventListener('DOMContentLoaded', () => {
            runHealthCheck();
        });
        
        // Auto-refresh every 30 seconds
        setInterval(runHealthCheck, 30000);
    </script>
</body>
</html>
